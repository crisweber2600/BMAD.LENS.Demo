# Governance Event Types — lens-work module
# Authoritative schema for governance events logged to event-log.jsonl
# Referenced by: Scribe agent, compliance-check workflow, resolve-constitution workflow, constitution workflow

event_types:

  constitution-created:
    description: "Logged when a new constitution is ratified"
    fields:
      timestamp:
        type: string
        format: ISO-8601
        required: true
      layer:
        type: string
        enum: [domain, service, microservice, feature]
        required: true
      name:
        type: string
        description: "Name of the entity (e.g., 'bmad', 'lens')"
        required: true
      articles_count:
        type: integer
        description: "Number of articles in the new constitution"
        required: true
      ratified_by:
        type: string
        description: "User who ratified the constitution"
        required: true
      git_commit_sha:
        type: string
        description: "Commit SHA for audit trail cross-reference"
        required: true
      initiative_id:
        type: string
        description: "Active initiative ID if applicable"
        required: false

  constitution-amended:
    description: "Logged when an existing constitution is amended"
    fields:
      timestamp:
        type: string
        format: ISO-8601
        required: true
      layer:
        type: string
        enum: [domain, service, microservice, feature]
        required: true
      name:
        type: string
        description: "Name of the entity whose constitution was amended"
        required: true
      amendment_summary:
        type: string
        description: "Brief description of the amendment"
        required: true
      articles_added:
        type: integer
        description: "Number of new articles added"
        required: true
      articles_modified:
        type: integer
        description: "Number of existing articles modified"
        required: true
      git_commit_sha:
        type: string
        description: "Commit SHA for audit trail cross-reference"
        required: true
      initiative_id:
        type: string
        description: "Active initiative ID if applicable"
        required: false

  compliance-evaluated:
    description: "Logged when an artifact is checked against resolved constitutional rules"
    fields:
      timestamp:
        type: string
        format: ISO-8601
        required: true
      artifact_path:
        type: string
        description: "Path to the evaluated artifact"
        required: true
      artifact_type:
        type: string
        description: "Type of artifact (e.g., prd, architecture-doc, story, code)"
        required: true
      constitution_resolved:
        type: string
        description: "Constitutions checked (e.g., 'domain/bmad + service/lens')"
        required: true
      pass_count:
        type: integer
        description: "Number of articles that passed compliance"
        required: true
      warn_count:
        type: integer
        description: "Number of articles with warnings (not verified)"
        required: true
      fail_count:
        type: integer
        description: "Number of articles that failed compliance"
        required: true
      initiative_id:
        type: string
        description: "Active initiative ID — REQUIRED for compliance events"
        required: true

  constitution-resolved:
    description: "Logged when the inheritance chain is walked and articles resolved"
    fields:
      timestamp:
        type: string
        format: ISO-8601
        required: true
      target_layer:
        type: string
        enum: [domain, service, microservice, feature]
        description: "The layer context being resolved"
        required: true
      layers_walked:
        type: integer
        description: "Number of layers in the resolved hierarchy"
        required: true
      total_articles:
        type: integer
        description: "Total articles in the resolved constitution"
        required: true
      initiative_id:
        type: string
        description: "Active initiative ID if applicable"
        required: false

  checklist-evaluated:
    description: "Logged when a requirements checklist is generated by the requirements-checklist workflow"
    fields:
      timestamp:
        type: string
        format: ISO-8601
        required: true
      initiative_id:
        type: string
        description: "Active initiative ID"
        required: true
      artifact_type:
        type: string
        description: "Type of artifact the checklist was generated for (e.g., prd, architecture-doc)"
        required: true
      layer:
        type: string
        enum: [domain, service, microservice, feature]
        required: true
      constitution_name:
        type: string
        description: "Name of the constitution evaluated against"
        required: true
      total_articles:
        type: integer
        description: "Total number of articles evaluated"
        required: true
      satisfied_count:
        type: integer
        description: "Number of articles satisfied by the artifact"
        required: true
      not_verified_count:
        type: integer
        description: "Number of articles that could not be verified"
        required: true
      compliance_percentage:
        type: number
        description: "Percentage of articles satisfied (0-100)"
        required: true

  cross-artifact-analyzed:
    description: "Logged when cross-artifact analysis completes across multiple planning artifacts"
    fields:
      timestamp:
        type: string
        format: ISO-8601
        required: true
      initiative_id:
        type: string
        description: "Active initiative ID"
        required: true
      artifacts_analyzed:
        type: integer
        description: "Number of artifacts included in the analysis"
        required: true
      total_findings:
        type: integer
        description: "Total number of findings across all categories"
        required: true
      critical_findings:
        type: integer
        description: "Number of critical-severity findings"
        required: true
      warning_findings:
        type: integer
        description: "Number of warning-severity findings"
        required: true
      traceability_score:
        type: number
        description: "Cross-artifact traceability score (0-100)"
        required: true

  amendment-propagated:
    description: "Logged when an amendment propagation plan is generated for child constitutions"
    fields:
      timestamp:
        type: string
        format: ISO-8601
        required: true
      initiative_id:
        type: string
        description: "Active initiative ID"
        required: true
      source_constitution:
        type: string
        description: "Name of the parent constitution that was amended"
        required: true
      amendment_id:
        type: string
        description: "Identifier of the amendment being propagated"
        required: true
      affected_children:
        type: integer
        description: "Number of child constitutions affected by the propagation"
        required: true
      conflicts_detected:
        type: integer
        description: "Number of conflicts detected during propagation analysis"
        required: true
      propagation_status:
        type: string
        enum: [pending, propagated, conflicts, failed]
        description: "Overall status of the propagation"
        required: true

  amendment-impact-analyzed:
    description: "Logged when ratification impact analysis is performed during a constitution amendment"
    fields:
      timestamp:
        type: string
        format: ISO-8601
        required: true
      initiative_id:
        type: string
        description: "Active initiative ID"
        required: true
      constitution_name:
        type: string
        description: "Name of the constitution being amended"
        required: true
      layer:
        type: string
        enum: [domain, service, microservice, feature]
        required: true
      amendment_summary:
        type: string
        description: "Brief description of the amendment analyzed"
        required: true
      affected_articles:
        type: integer
        description: "Number of articles affected by the amendment"
        required: true
      impact_severity:
        type: string
        enum: [low, medium, high, critical]
        description: "Assessed severity of the amendment impact"
        required: true

  sync-report-generated:
    description: "Logged when a child constitution sync report is generated after a parent amendment"
    fields:
      timestamp:
        type: string
        format: ISO-8601
        required: true
      initiative_id:
        type: string
        description: "Active initiative ID"
        required: true
      parent_constitution:
        type: string
        description: "Name of the parent constitution that triggered the sync"
        required: true
      child_constitutions_count:
        type: integer
        description: "Number of child constitutions included in the sync report"
        required: true
      sync_status:
        type: string
        enum: [in-sync, drift-detected, conflicts]
        description: "Overall sync status across child constitutions"
        required: true
      conflicts:
        type: integer
        description: "Number of conflicts found during sync analysis"
        required: true
